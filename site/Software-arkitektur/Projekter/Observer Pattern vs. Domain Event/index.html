
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Min læringsportfolio for AI, ML og Software Arkitektur">
      
      
      
      
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Observer Pattern vs. Domain Event - Semester Portfolio</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.618322db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#observer-pattern" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Semester Portfolio" class="md-header__button md-logo" aria-label="Semester Portfolio" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Semester Portfolio
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Observer Pattern vs. Domain Event
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Semester Portfolio" class="md-nav__button md-logo" aria-label="Semester Portfolio" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Semester Portfolio
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hjem
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    AI-ML
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    AI-ML
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../AI-ML/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AI &amp; ML – Oversigt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    AI-ML-forståelse
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    AI-ML-forståelse
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../AI-ML/AI-ML-forst%C3%A5else/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Oversigt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Projekter
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Projekter
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../AI-ML/projekter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Oversigt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Blog
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Blog
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Software Arkitektur Blog
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Software Arkitektur Blog
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Blog/Software-arkitektur-blog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Software Arkitektur Blog – Oversigt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    AI & ML Blog
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    AI & ML Blog
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Blog/AI-ML-blog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AI &amp; ML Blog – Oversigt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Software-arkitektur
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Software-arkitektur
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Software Arkitektur – Oversigt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Generelt
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Generelt
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Generelt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Generelt – Oversigt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ide" class="md-nav__link">
    <span class="md-ellipsis">
      
        Idé:
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#karakteristika" class="md-nav__link">
    <span class="md-ellipsis">
      
        Karakteristika:
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<p>For at genopfriske læringen omkring observer pattern fra tidligere semestre og se hvordan vi kan bruge det i vores projekt, så har jeg valgt at lave et lille projekt og se hvordan det kan bruges i en situation der passer til vores projekt i forhold til at observere ved oprettelse af ny content via post hvor der så bliver lyttet samt reageret på eventet, hvilket resulterer i udsendelsen af en email.</p>
<h1 id="observer-pattern">**Observer Pattern</h1>
<h3 id="ide">Idé:</h3>
<p>Et objekt (subject) holder styr på flere observers.<br />
Når subject ændrer sig, notificerer den alle observers direkte.</p>
<h3 id="karakteristika">Karakteristika:</h3>
<ul>
<li>direkte reference mellem subject og observer</li>
<li>tæt kobling</li>
<li>objekter kender ofte hinanden</li>
<li>typisk synkront</li>
<li>er bedst i UI og simple apps</li>
<li>fungerer som “hvem lytter på mig?”-model</li>
</ul>
<h1 id="domain-events-ddd"><strong>Domain Events (DDD)</strong></h1>
<h3 id="ide_1">Idé:</h3>
<p>Domænet udsender en hændelse — men ved <em>ikke</em> hvem der reagerer på den.</p>
<h3 id="karakteristika_1">Karakteristika:</h3>
<ul>
<li><strong>ingen references</strong> mellem domain og event handlers</li>
<li><strong>lav coupling</strong></li>
<li><strong>rent domæne</strong></li>
<li>hændelser beskriver forretningssituationer (ikke UI-tilstande)</li>
<li>Application-laget håndterer eventet</li>
<li>Infrastructure kan håndtere sideeffekter</li>
</ul>
<h3 id="observer-pattern_1">Observer Pattern</h3>
<p>Her ses opbygningen af mit observer spikeprojekt.
<img alt="Pasted image 20251121115652.png" src="../../../images/Pasted%20image%2020251121115652.png" /></p>
<h3 id="1-subject-contentpublisher"><strong>1) Subject → ContentPublisher</strong></h3>
<p>Den der udsender beskeder / hændelser.<br />
ContentPublisher implementerer <strong>ISubject</strong>, som er kontrakten for et subject.<br />
Her kan observers blive <strong>tilmeldt (Attach)</strong> eller <strong>frameldt (Detach)</strong>.<br />
Når noget sker, kalder subject <strong>Notify</strong>, som sender en besked til alle observers.</p>
<p><img alt="Pasted image 20251121121805.png" src="../../../images/Pasted%20image%2020251121121805.png" /></p>
<h3 id="2-observers-emailsubscriber-pushsubscriber"><strong>2) Observers → EmailSubscriber / PushSubscriber</strong></h3>
<p>Modtagere af beskeder.<br />
De implementerer <strong>IObserver</strong>, som er kontrakten for hvordan observers reagerer.<br />
Når de modtager <code>Update(message)</code>, håndterer de hændelsen på hver deres måde.</p>
<p><img alt="Pasted image 20251121123919.png" src="../../../images/Pasted%20image%2020251121123919.png" /></p>
<h3 id="3-interfaces-isubject-og-iobserver"><strong>3) Interfaces → ISubject og IObserver</strong></h3>
<p>Kontrakten for hvordan subject og observers skal opføre sig.<br />
ISubject styrer notifikationerne.<br />
IObserver styrer hvordan subscribers reagerer.
<img alt="Pasted image 20251121122737.png" src="../../../images/Pasted%20image%2020251121122737.png" /></p>
<p>ISubject er kontrakten for publishers (ContentPublisher) og udsendelsen af beskeder og hændelser
<img alt="Pasted image 20251121123007.png" src="../../../images/Pasted%20image%2020251121123007.png" /></p>
<h3 id="flowet-i-min-kode"><strong>Flowet i min kode</strong></h3>
<ol>
<li>Observers tilmelder sig via <code>Attach()</code></li>
<li>ContentPublisher publicerer nyt content og kalder <code>Notify()</code></li>
<li>Notify kalder <code>Update(message)</code> på alle observers</li>
<li>Email og Push reagerer hver for sig</li>
</ol>
<p><strong>Pointen med Observer Pattern:</strong><br />
Det giver løs kobling: Subject kender ikke implementeringen af observers, kun interfacet.<br />
Det gør systemet fleksibelt og udvideligt.</p>
<h3 id="domain-event">Domain event</h3>
<p>Her har jeg afprøvet et domain event implementering for at sammenligne med Observer pattern.
Jeg har i dette Spike Project ikke brugt MediatR til at styre handlers for at få et bedre indblik i hvordan DDD-event fungerer reelt.</p>
<p>Her er projektets opbygning.
<img alt="Pasted image 20251121134220.png" src="../../../images/Pasted%20image%2020251121134220.png" /></p>
<h3 id="application-laget"><strong>Application-laget</strong></h3>
<p>Her ligger klasser, der <strong>håndterer hændelser</strong> og styrer, hvad der skal ske i systemet.</p>
<ul>
<li>
<p><strong>DomainEventBus.cs</strong><br />
    Event-bussen der sender domain events videre til de rigtige handlers.</p>
</li>
<li>
<p><strong>IDomainEventHandler.cs</strong><br />
    Interface for alle handlers. Bestemmer hvordan en handler skal reagere på et event.</p>
</li>
<li>
<p><strong>PostPublishedHandler.cs</strong><br />
    Selve handleren for PostPublishedEvent. Kører application-logik som email og kald til domænet.</p>
</li>
</ul>
<p><em>Application-laget reagerer på events og binder domæne og infrastruktur sammen.</em></p>
<hr />
<h3 id="domain-laget"><strong>Domain-laget</strong></h3>
<p>Her ligger alt, der hører til <strong>selve domænelogikken</strong> — altså kernefunktionalitet.</p>
<ul>
<li>
<p><strong>ContentService.cs</strong><br />
    Domæneservice med forretningslogik. Den genererer nye Domain Events.</p>
</li>
<li>
<p><strong>IDomainEvent.cs</strong><br />
    Kontrakten for alle domain events.</p>
</li>
<li>
<p><strong>PostPublishedEvent.cs</strong><br />
    Et konkret domain event. Repræsenterer “post er publiceret”.</p>
</li>
</ul>
<p><em>Domain-laget er systemets kerne og indeholder regler, entiteter og events.</em></p>
<hr />
<h3 id="infrastructure-laget"><strong>Infrastructure-laget</strong></h3>
<p>Her ligger kode, der taler med eksterne systemer eller ressourcer.</p>
<ul>
<li><strong>EmailNotifier.cs</strong><br />
    En simpel infrastrukturservice for at sende e-mails.</li>
</ul>
<p><em>Infrastructure er afhængigt af eksterne ressourcer og bruges af application layer.</em></p>
<p>EventBus
EventBus er programmets central, der styrer indkomne events.
Den ved hvordan de kaldes og den ved hvilke handlers der håndterer hvilke events og kan derfor distriuere dem til den korrekte handler. I dette projekt har vi DomainEventBus som vores eventBus.</p>
<p><img alt="Pasted image 20251121134623.png" src="../../../images/Pasted%20image%2020251121134623.png" />
Priavte readonly List..- Her laves listen over alle typer eventhandlers.
i RegisterHandler metoden - Her registreres en handler og bliver gemt til et domain event. Det er her den korrekte handler registreres. Den der lytter efter eventet.
PublishAsync metoden - Her sendes eventet ud i systemet og metoden udføres på eventet.</p>
<p><img alt="Pasted image 20251121135800.png" src="../../../images/Pasted%20image%2020251121135800.png" /></p>
<p>I PostPublishedEvent - Der implmenteres kontrakten fra IDomainEventHandler.
Den lytter altså efter PostPublishedEvent og bliver deror kaldt af DomainEventBus.</p>
<p>De 3 services fra EmailNotifier, ContentService og DomainEventBus bliver injiceret i constructoren, så de kan bruges.
EmailNotifier - Sender email ved event.
ContentService - kan lave nye events
DomainEventBus - Kan publisere event fra domænet.</p>
<p>I handleAsync metode - Kaldes automatisk når Der er et PostPublishedEvent i DomainEventBus.
Den udfører logikken for EmailNotifier og ContentService.</p>
<p>Til sidst bliver der via foreach - Foreach tager hvert event, som domænet selv har skabt, og sender det tilbage ind i event-systemet, så de også bliver håndteret.
Her bruges liste som standard for at kunne håndtere flere events. Hvis flere events udløses som fx. notifikationer eller logging.
<img alt="Pasted image 20251121140922.png" src="../../../images/Pasted%20image%2020251121140922.png" /></p>
<p>ContentService
<img alt="Pasted image 20251121144458.png" src="../../../images/Pasted%20image%2020251121144458.png" />
Her kan der skabes events i _pendingEvents
Og via publishPost() - publiseres post og genereres et nyt domæne event.</p>
<p>ContentSerivce ligger i domænelaget, da den publiserer post og domæne events.</p>
<p>Dette kan derefter bruges af PostPublishHandler - Der kan hente listen og sende events videre i EventBus.
ContentService udfører forretningslogik og genererer nye Domain Events, som gemmes i en liste, så de senere kan sendes videre til EventBus og blive håndteret.</p>
<p><img alt="Pasted image 20251121145221.png" src="../../../images/Pasted%20image%2020251121145221.png" />
PostPublishedEvent - Indeholder de data handlers bruger, her i form af author og title og den repræsenterer hændelsen at " Et indlæg blev publiceret"
Den repræsenterer hvad der sker i domænet og hører derfor til i domænelaget.</p>
<p>EmailNotifier - simulerer sending af email og ligger i infrastructure da den hører til ydre services der kobles på systemet.</p>
<h1 id="domain-events-i-the-way-of-coherence">**Domain Events i  The Way of Coherence</h1>
<p>I <em>The Way of Coherence</em> anvender vi Domain Events for at sikre en klar og fleksibel adskillelse mellem domænelogikken og de procesflows, der skal køre efter en forretningshændelse. Domænehændelserne bruges til at markere, at noget betydningsfuldt er sket i systemets kerne, uden at domænelaget behøver at kende de konkrete reaktioner eller eksterne konsekvenser.</p>
<p>Det passer direkte ind i både Clean Architecture og jeres Vertical Slice-struktur. Domænet rejser hændelsen, og den enkelte slice i Application-laget håndterer den del af logikken, der vedrører netop det forløb.</p>
<hr />
<h2 id="1-hvad-er-et-domain-event-i-projektet"><strong>1. Hvad er et Domain Event i projektet?</strong></h2>
<p>Et Domain Event er en lille model, der beskriver en vigtig forretningshændelse. Når et indlæg bliver udgivet, er dette en central handling i systemets Content-domæne. I stedet for at lade domæneobjekterne selv stå for logging, notifikationer eller statistik, rejser de blot et Domain Event.</p>
<p>På den måde kan andre dele af systemet reagere, uden at domænet skal ændres eller opnå nye afhængigheder.</p>
<hr />
<h2 id="2-hvorfor-bruger-vi-domain-events"><strong>2. Hvorfor bruger vi Domain Events?</strong></h2>
<p>Domain Events anvendes for at opnå:</p>
<ul>
<li>Lav kobling mellem lagene.</li>
<li>Et domænelag uden tekniske afhængigheder til logging, e-mails, UI eller applikationsservices.</li>
<li>En fleksibel arkitektur, hvor nye reaktioner kan tilføjes uden ændringer i domænemodellerne.</li>
<li>En vertikal slice-opdeling, hvor hver slice kan reagere på hændelser, uden at det påvirker andre features.</li>
<li>Lettest mulig testbarhed, da domænelogik kan testes isoleret.</li>
</ul>
<p>Vi valgte Domain Events i stedet for Observer Pattern, fordi Domain Events giver løs kobling, rent domæne, høj testbarhed og perfekt integration med Clean Architecture, DDD og Vertical Slice Architecture.  </p>
<blockquote>
<p>Observer Pattern ville have skabt coupling i domænet og brudt arkitekturens afhængighedsregler.</p>
</blockquote>
<hr />
<h2 id="3-hvor-rejser-vi-hndelsen"><strong>3. Hvor rejser vi hændelsen?</strong></h2>
<p>Når et indlæg udgives via domænemetoden <em>Publish()</em>, registrerer objektet selv en Domain Event. Domænelaget reagerer altså ikke på hændelsen – det fortæller blot, at den er sket.</p>
<p>Dette følger principperne i Domain-Driven Design:<br />
Domænet kender reglerne og ved, hvornår noget er betydningsfuldt, men det kender ikke resten af systemet.</p>
<hr />
<h2 id="4-hvordan-kommer-hndelsen-videre-i-systemet"><strong>4. Hvordan kommer hændelsen videre i systemet?</strong></h2>
<p>Når indlægget gemmes via repositoryet, opsamler infrastrukturen alle Domain Events, der er rejst af dette objekt.<br />
Disse events sendes videre gennem en Event Dispatcher, som er placeret i Infrastructure-laget.</p>
<p>Dispatcheren sender hændelserne ind i MediatR-pipelinen, hvor hver hændelse omsættes til en notifikation, som Application-laget kan reagere på.</p>
<p>Domænet skal ikke kende MediatR og har ingen afhængighed til tekniske biblioteker.</p>
<hr />
<h2 id="5-hvordan-reagerer-application-laget"><strong>5. Hvordan reagerer Application-laget?</strong></h2>
<p>I Application-laget ligger event handlers i de relevante vertical slices.<br />
For eksempel i <em>Features/Posts/EventHandlers</em> håndteres hændelsen om, at et indlæg er blevet udgivet.</p>
<p>Her kan vi udføre sideeffekter som:</p>
<ul>
<li>opdatere statistikker</li>
<li>skrive audit-logs</li>
<li>opdatere dashboardet</li>
<li>sende beskeder videre til andre systemdele</li>
</ul>
<p>Det er kun Application-laget, der foretager disse opgaver.<br />
Domænelaget har ingen viden om, hvad der sker efterfølgende.</p>
<hr />
<h2 id="6-hvordan-passer-det-ind-i-vertical-slice-architecture"><strong>6. Hvordan passer det ind i Vertical Slice Architecture?</strong></h2>
<p>Vertical Slice betyder, at hver feature (fx Posts) indeholder alt, der vedrører den funktion: commands, queries, validators, event handlers osv.</p>
<p>Domain Events passer godt ind, fordi:</p>
<ul>
<li>En event handler ligger i den slice, som er relevant for hændelsen.</li>
<li>Hver slice kan reagere på events uden at få afhængigheder til andre slices.</li>
<li>Nye slices kan tilføje flere handlers på den samme event uden at røre eksisterende kode.</li>
</ul>
<p>Det giver en naturlig, isoleret og let at udvide implementering.</p>
<h2 id="7-afslutning">**7. Afslutning</h2>
<p>Ved at kombinere Domain Events med Vertical Slice og Clean Architecture opnår projektet:</p>
<ul>
<li>En stærk adskillelse mellem forretningslogik og efterfølgende handlinger.</li>
<li>Et domænelag uden teknisk støj og uden afhængigheder.</li>
<li>Et application-lag der kan udvides slice for slice.</li>
<li>Fleksibilitet til at bygge nye forløb, der reagerer på eksisterende hændelser.</li>
<li>En arkitektur, der er robust, skalerbar og let at teste.</li>
</ul>
<h1 id="domain-events-vs-observer-pattern-og-hvorfor-vi-valgte-domain-events">Domain Events vs Observer Pattern (og hvorfor vi valgte Domain Events)**</h1>
<p>I dette indlæg går vi i dybden med to patterns, der ligner hinanden i idé, men fungerer fundamentalt forskelligt i praksis:</p>
<ul>
<li><strong>Observer Pattern</strong></li>
<li><strong>Domain Events (DDD)</strong></li>
</ul>
<p>Begge bruges til at reagere på hændelser.<br />
Men de gør det på <em>vidt forskellige måder</em>, og valget har stor betydning for arkitektur, koblingsgrad og domænedesign.</p>
<p>I vores projekt valgte vi <strong>Domain Events</strong> — og her forklarer vi præcis hvorfor.</p>
<hr />












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.expand", "navigation.sections", "navigation.top", "navigation.footer"], "search": "../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>